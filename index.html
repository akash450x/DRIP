<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>DRIP</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<style>
:root{ --primary:#FF9933; --bg:#000; --border:#1b1b1b; }
*{margin:0;padding:0;box-sizing:border-box}
body{ background:#000; color:#fff; font-family:-apple-system,sans-serif; height:100vh; overflow:hidden; }

/* üî± STICKY FIX: Global Splash */
#splash {
    position: fixed; inset: 0; background: #000; 
    display: flex; flex-direction: column; align-items: center; justify-content: center; 
    z-index: 100000; cursor: pointer;
}
.flag-wrap{width:180px;height:110px;background:linear-gradient(to bottom, #FF9933 33.3%, #fff 33.3%, #fff 66.6%, #128807 66.6%);position:relative;border-radius:4px;}
.chakra{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:30px;height:30px;background:url("https://upload.wikimedia.org/wikipedia/commons/1/17/Ashoka_Chakra.svg") center/contain no-repeat}
.namaste-text{margin-top:15px;font-family:'Bebas Neue';letter-spacing:6px;color:#D4AF37;font-size:26px;}
.bypass-hint { position: absolute; bottom: 30px; font-size: 8px; color: #333; }

#auth-gate { display:none; position:fixed; inset:0; background:#000; z-index:9000; flex-direction:column; align-items:center; justify-content:center; }
.auth-btn { padding:16px 32px; background:#fff; color:#000; border:none; border-radius:50px; font-weight:bold; width:80%; max-width:300px; margin-top:20px; font-size:14px; }

/* REELS & MINI ACTIONS */
#reels { height: 100%; overflow-y: scroll; scroll-snap-type: y mandatory; background: #000; }
#reels::-webkit-scrollbar { display: none; }
.reel { height: 100%; width: 100%; position:relative; scroll-snap-align: start; background: #000; -webkit-transform: translateZ(0); }
.reel video, .reel img { width:100%; height:100%; object-fit:cover; position: absolute; top: 0; left: 0; z-index: 1; }

.reel-actions { 
    position: absolute !important; right: 12px !important; bottom: 100px !important; 
    display: flex !important; flex-direction: column !important; gap: 20px !important; 
    z-index: 8000 !important; align-items: center !important;
}
.reel-actions button { 
    background: none !important; border: none !important; color: #fff !important; 
    width: 25px !important; height: 25px !important; font-size: 20px !important; 
    display: flex !important; align-items: center !important; justify-content: center !important; 
}
.auto-btn-mini { font-size: 5px !important; font-weight: 900; color: #444; opacity: 0.5; }

/* COMMENTS PANEL */
#comment-panel {
    position: fixed; bottom: -100%; left: 0; width: 100%; height: 60%;
    background: #0a0a0a; border-top: 1px solid #222; z-index: 9500;
    transition: 0.4s ease; display: flex; flex-direction: column; border-radius: 20px 20px 0 0;
}
#comment-panel.active { bottom: 0; }

/* APP UI */
#app { display:none; height:100vh; flex-direction:column; position: relative; }
.header { height:60px; padding:0 16px; display:flex; align-items:center; border-bottom:1px solid var(--border); }
.brand { font-family:'Bebas Neue'; font-size:28px; color:var(--primary); }
.nav { height:75px; display:flex; border-top:1px solid #1b1b1b; background:#000; z-index: 8500; }
.tab { flex:1; background:none; border:none; color:#333; font-size:24px; }
.tab.active { color:var(--primary) }
</style>
</head>

<body>

<div id="splash" onclick="forceUnlock()">
    <div class="flag-wrap"><div class="chakra"></div></div>
    <div class="namaste-text">NAMASTE</div>
    <div class="bypass-hint">Tap screen to enter Empire</div>
</div>

<div id="auth-gate">
    <h1 style="font-family:'Bebas Neue'; font-size:50px; color:var(--primary);">DRIP</h1>
    <button class="auth-btn" onclick="googleLogin()">Sign In with Google</button>
</div>

<div id="comment-panel">
    <div style="padding:15px; border-bottom:1px solid #111; display:flex; justify-content:space-between;">
        <b>Comments</b><span onclick="toggleComm()" style="color:#444;">‚úï</span>
    </div>
    <div id="comm-list" style="flex:1; overflow-y:auto; padding:20px;"></div>
    <div style="padding:15px; display:flex; gap:10px; border-top:1px solid #111;">
        <input type="text" id="c-input" placeholder="Add a comment..." style="flex:1; background:#111; border:1px solid #222; border-radius:10px; color:#fff; padding:10px;">
        <button onclick="postComm()" style="background:var(--primary); border:none; padding:0 15px; border-radius:10px; font-weight:bold;">POST</button>
    </div>
</div>

<div id="app">
    <header class="header"><div class="brand">DRIP</div></header>
    <div class="view">
        <div id="home" class="page active" style="padding:40px; text-align:center;">
            <p style="color:#666; line-height:1.8;">DRIP is India‚Äôs next-generation platform.<br><span>EST 2026</span></p>
        </div>
        <div id="reels" class="page"></div>
        <div id="create" class="page" style="padding:20px;">
            <button onclick="pick('video/*')" style="width:100%; padding:15px; background:#111; color:#fff; border:1px solid #222; border-radius:12px;">PICK MEDIA</button>
            <textarea id="desc" placeholder="Caption..." style="width:100%; margin-top:15px; background:#111; color:#fff; border:1px solid #222; border-radius:12px; padding:12px;"></textarea>
            <button onclick="publish()" style="width:100%; margin-top:15px; padding:15px; background:var(--primary); color:#000; font-weight:bold; border:none; border-radius:12px;">PUBLISH</button>
            <input type="file" id="file" hidden>
        </div>
        <div id="profile" class="page" style="text-align:center; padding:20px;">
            <h2 id="uName">AKASH</h2>
            <button onclick="logoutEmpire()" style="width:100%; margin-top:20px; padding:15px; background:#111; border:1px solid #222; color:#fff; border-radius:12px;">LOG OUT</button>
        </div>
    </div>
    <nav class="nav">
        <button class="tab active" onclick="go('home',this)">üè†</button>
        <button class="tab" onclick="go('reels',this)">‚ñ∂</button>
        <button class="tab" onclick="go('create',this)">Ôºã</button>
        <button class="tab" onclick="go('search',this)">üîç</button>
        <button class="tab" onclick="go('profile',this)">üë§</button>
    </nav>
</div>

<script>
// üî± BYPASS LOGIC
function forceUnlock() {
    document.getElementById('splash').style.display = 'none';
    if (!firebase.auth().currentUser) {
        document.getElementById('auth-gate').style.display = 'flex';
    } else {
        document.getElementById('app').style.display = 'flex';
    }
}

// FIREBASE INIT
const config = {
    apiKey: "AIzaSyA8SMoQI3UxfhZwdq65H81Jv31Q8wUKxMM",
    authDomain: "drip-india.firebaseapp.com",
    projectId: "drip-india",
    storageBucket: "drip-india.firebasestorage.app",
    messagingSenderId: "40598053043",
    appId: "1:40598053043:web:b800c05afba716974690c6"
};
firebase.initializeApp(config);
const auth = firebase.auth();

auth.onAuthStateChanged(user => {
    // Auto-unlock on auth state
    setTimeout(forceUnlock, 1000);
    if (user) {
        document.getElementById('uName').innerText = user.displayName || "AKASH";
    }
});

function googleLogin() {
    const provider = new firebase.auth.GoogleAuthProvider();
    provider.setCustomParameters({ prompt: 'select_account' });
    auth.signInWithPopup(provider);
}

function logoutEmpire() { if(confirm("Log Out?")) auth.signOut().then(() => location.reload()); }

function go(id,btn){
    document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    btn.classList.add('active');
}

function toggleComm() { document.getElementById('comment-panel').classList.toggle('active'); }
function postComm() {
    const i = document.getElementById('c-input');
    const l = document.getElementById('comm-list');
    if(!i.value) return;
    const d = document.createElement('div');
    d.innerHTML = `<b style="color:var(--primary); font-size:11px;">@AKASH</b><p style="font-size:13px;">${i.value}</p>`;
    l.prepend(d); i.value = "";
}

function pick(t){ const f = document.getElementById('file'); f.accept = t; f.click(); }

let auto=false, autoInt;
function toggleAuto(btn){
    auto = !auto; btn.style.color = auto ? "var(--primary)" : "#444";
    if(auto) autoInt = setInterval(() => document.getElementById('reels').scrollBy({top: window.innerHeight, behavior: 'smooth'}), 4000);
    else clearInterval(autoInt);
}

function publish(){
    const f = document.getElementById('file'); const d = document.getElementById('desc');
    if(!f.files[0]) return alert("Select media!");
    const url = URL.createObjectURL(f.files[0]); const isVid = f.files[0].type.includes('video');
    const reel = document.createElement("div"); reel.className = "reel";

    // Double Tap
    reel.onmousedown = (e) => {
        const now = Date.now();
        if (now - (reel.dataset.lt || 0) < 300) {
            reel.querySelector('.btn-like').style.color = '#FF9933';
            const h = document.createElement('div'); h.innerHTML='‚ù§Ô∏è'; h.style.position='absolute'; h.style.fontSize='80px';
            h.style.left = e.clientX+'px'; h.style.top = (e.clientY - reel.getBoundingClientRect().top)+'px';
            h.style.zIndex='100'; h.style.pointerEvents='none'; reel.appendChild(h);
            setTimeout(()=>h.remove(), 800);
        }
        reel.dataset.lt = now;
    };

    reel.innerHTML = `
        ${isVid ? `<video src="${url}" autoplay muted loop playsinline webkit-playsinline></video>` : `<img src="${url}">`}
        <div style="position:absolute; bottom:20px; left:16px; font-size:12px; background:rgba(0,0,0,0.5); padding:8px; border-radius:8px; z-index:99;">${d.value || "DRIP"}</div>
        <div class="reel-actions">
            <button class="btn-like" onclick="event.stopPropagation(); this.style.color='#FF9933'">‚ù§Ô∏è</button>
            <button onclick="event.stopPropagation(); toggleComm()">üí¨</button>
            <button onclick="event.stopPropagation(); alert('Shared')">‚ÜóÔ∏è</button>
            <button onclick="event.stopPropagation(); alert('Saved')">‚¨áÔ∏è</button>
            <button onclick="event.stopPropagation(); this.innerText='‚úÖ'">üë§</button>
            <button onclick="event.stopPropagation(); toggleAuto(this)" class="auto-btn-mini">AUTO</button>
        </div>`;
    
    document.getElementById('reels').appendChild(reel);
    d.value = ""; f.value = "";
    go('reels', document.querySelectorAll('.tab')[1]);
}
</script>
</body>
</html>
